<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>spr_achievementmanager</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>-5</depth>
  <persistent>-1</persistent>
  <parentName>manager_parent</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Init

ach_list = ds_list_create();
print("ACHIEVEMENT_MANAGER: 'Manager Initialized' ");

ach_count = 0;
ach_init_list();
print("ACHIEVEMENT_MANAGER: 'List Initialized' ");

ach_queue = ds_queue_create();

unlocked_count = 0;

//Variables for drawing popup
_unlocked       =   false;
_icon           =   ach_icon_hidden;
_displayname    =   "";
_desc           =   "";
_prog           =   0;
_total          =   1;
_showProg       =   false;

//Animation variables
show_ach = ach_get_info(1);
show_anim_delay = 3*room_speed;
anim_flip = false;
anim_y = sprite_get_height(ach_unlocked_border)+1;
show_anim = false;
show_anim_first = true;

showPopups = true;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>anim_flip = true;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>var q_total = ds_queue_size(achievement_queue);
if !show_anim and q_total &gt; 0
{
    var _nextach = ds_queue_dequeue(achievement_queue);
    ach_show_popup(_nextach);
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if show_anim and showPopups
{
    if is_undefined(show_ach)
    {
        print("ACHIEVEMENT POPUP IS UNDEFINED!");
        show_anim = false;
        exit;
    }
    
    //var _unlocked, _icon, _displayname, _desc, _prog, _total, _showProg;
    
    if show_anim_first
    {
        _unlocked = show_ach[? "unlocked"];
        _icon = show_ach[? "icon"];
        _displayname = show_ach[? "displayname"];
        _desc = show_ach[? "desc"];
        _prog = show_ach[? "progress"];
        _total = show_ach[? "progresstotal"];
        _showProg = show_ach[? "showprogress"];
        if _unlocked {audio_play_sound(snd_achievement, 1, 0);}
        
        show_anim_first = false;
    }
    
    var border_spr = ach_unlocked_border;
    var borderw = sprite_get_width(border_spr);
    var borderh = sprite_get_height(border_spr);
    var borderx = viewx+vieww-borderw;
    var bordery = viewy - anim_y; //var bordery = viewy+viewh-borderh + anim_y; MOVED FROM BOTTOM RIGHT TO TOP RIGHT
    
    draw_sprite(border_spr, 0, borderx, bordery);
    if !_unlocked {draw_sprite_alpha(ach_unlocked_border_faded, 0, borderx, bordery, 0.85);}
    
    var ach_spr = _icon//ach_icon_holybbq;
    var achw = sprite_get_width(ach_spr);
    var achh = sprite_get_height(ach_spr);
    var achoffset = 2;
    var achx = borderx+achoffset+(achw/2);
    var achy = bordery+achoffset+(achh/2)
    draw_sprite(ach_spr, 0, achx, achy);
    if !_unlocked {draw_sprite_alpha(ach_icon_faded, 0, achx, achy, 0.85);}
    
    draw_set_font(font_menu);
    draw_set_halign(fa_left);
    draw_set_valign(fa_top);
    
    var str = _displayname//"ACHIEVEMENT";
    var strscale = 0.5;
    var strx = borderx + 35;
    var stry = bordery + 4;
    var strcol = c_white; if !_unlocked {strcol = c_ltgray;}
    var strcol2 = c_ltgray; if !_unlocked {strcol2 = c_dkgray;}
    var shadowcol = c_black;
    
    draw_text_transformed_colour(strx+1, stry+1, str,
     strscale, strscale, 0, shadowcol, shadowcol, shadowcol, shadowcol, 1);
    draw_text_transformed_colour(strx, stry, str,
     strscale, strscale, 0, strcol, strcol, strcol2, strcol2, 1);
     
    var strscale = 0.4;
    var str = string_wordwrap_width(_desc, borderw-35, "#", false, strscale)
    var strx = borderx + 35;
    var stry = bordery + 10;
    var strcol = c_ltgray; if !_unlocked {strcol = c_ltgray;}
    var strcol2 = c_ltgray; if !_unlocked {strcol2 = c_dkgray;}
    var shadowcol = c_black;
    
    draw_text_transformed_colour(strx+1, stry+1, str,
     strscale, strscale, 0, shadowcol, shadowcol, shadowcol, shadowcol, 1);
    draw_text_transformed_colour(strx, stry, str,
     strscale, strscale, 0, strcol, strcol, strcol2, strcol2, 1);

    if _showProg
    {
        draw_set_halign(fa_right);
        draw_set_valign(fa_bottom);
    
        var _progStr = "(" + string(_prog) + "/" + string(_total) + ")"
        
        var str = _progStr
        var strscale = 0.4;
        var strx = borderx+borderw - 3;
        var stry = bordery+borderh - 3;
        var strcol = c_white;
        var strcol2 = c_ltgray;
        var shadowcol = c_black;
        
        draw_text_transformed_colour(strx+1, stry+1, str,
         strscale, strscale, 0, shadowcol, shadowcol, shadowcol, shadowcol, 1);
        draw_text_transformed_colour(strx, stry, str,
         strscale, strscale, 0, strcol, strcol, strcol2, strcol2, 1);
    }
    
    var _inc = 4;
    if !anim_flip //if !anim_flip RESET
    {
        if anim_y &gt; 0 then anim_y-=_inc;
        if anim_y &lt;= 0
        {
            anim_y = 0;
            if alarm[0] &lt; 1 then alarm[0] = show_anim_delay;//anim_flip = true;
        }
    }
    else
    {
        if anim_y &lt; borderh then anim_y+=_inc;
        if anim_y &gt;= borderh
        {
            anim_y = borderh;
            show_anim = false;
            show_anim_first = true;
        }
    }
    
    draw_set_halign(fa_left);
    draw_set_valign(fa_top);
}




</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="10" enumb="117">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>var _num = irandom_range(0, (achievement_count-1));
/*ach_show_popup(_num);
var _tog = ach_is_unlocked(_num)
ach_set_unlocked(_num, !_tog);*/
ach_award(_num);
//DEBUG REMOVE LATER
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
